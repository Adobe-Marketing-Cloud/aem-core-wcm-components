<!--/*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~ Copyright 2020 Adobe
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/-->
<div class="cmp-pdfviewer" 
     data-sly-use.pdfViewer="com.adobe.cq.wcm.core.components.models.PdfViewer"
     data-sly-use.template="core/wcm/components/commons/v1/templates.html"
     id="${pdfViewer.id}"
     data-sly-set.clientIdError="${'Please setup Context Aware Configuration (com.adobe.cq.wcm.core.components.internal.services.pdfviewer.PdfViewerCaConfig) in /conf and link it using sling:configRef on any current/parent node.' @ i18n}"
     data-sly-set.documentPathError="${'Please select a document to display.' @ i18n}"
     data-sly-set.error="${!pdfViewer.clientId ? clientIdError : (!pdfViewer.documentPath ? documentPathError : false)}"
     data-sly-test="${!error}">

     <style>
          .cmp-pdfviewer__full-window, .cmp-pdfviewer__sized-container {
               height: ${pdfViewer.viewerHeight @ context='styleToken'} !important;
          }
     </style>

     <div id="${pdfViewer.id}-content" class="cmp-pdfviewer__content ${pdfViewer.containerClass @ context='html'}"></div>
     <script type="text/javascript">
          document.addEventListener("adobe_dc_view_sdk.ready", function(){ 
               var adobeDCView = new AdobeDC.View({
                    clientId: "${pdfViewer.clientId @ context='scriptToken'}",
                    divId: "${pdfViewer.id @ context='unsafe'}-content",
                    reportSuiteId: "${pdfViewer.reportSuiteId @ context='scriptToken'}"
               });
               adobeDCView.previewFile({
                    content:{location: {url: "${pdfViewer.documentPath @ context='unsafe'}"}},
                    metaData:{fileName: "${pdfViewer.documentFileName @ context='unsafe'}"}
               }, ${pdfViewer.viewerConfigJson @ context='unsafe'});
          });
     </script>
</div>
<sly data-sly-call="${template.placeholder @ isEmpty=error, classAppend='cmp-pdfviewer', emptyTextAppend=error}"></sly>
